<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/register.css">
    <link rel="stylesheet" href="css/nav.css">
    <!-- Custom CSS -->
    <style>
         /* Loading Overlay Style */
.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999; /* To make sure it appears above everything */
}

/* Apply background blur to the main content when loading is active */
.blur-background {
    filter: blur(5px);
}

/* Center spinner */
.spinner-border {
    width: 3rem;
    height: 3rem;
    border-width: 0.3rem;
}

    </style>

<body>
    <div id="nav">
        <div class="container d-flex justify-content-between align-items-center">
            <div class="col-4">
                <img src="images/icons8-menu-bar-64.png" alt="" class="sidebar-toggle img-fluid" id="sidebarToggle" style="width: 20%;">
            </div>
            <div class="col-4 text-center">
                <img src="images/logo.png" alt="Logo" id="logo" style="max-width: 100%;">
            </div>
            <div class="col-4 text-end">
                <img src="icon/Mask group.png" alt="Profile Icon" style="max-width: 100%;">
            </div>
        </div>
    </div>

    <div class="container-fluid" id="mainContent">
        <div class="row">
            <div class="container">
                <div class="row">
                    <!-- Sidebar -->
                    <div class="col-sm-12 col-xl-2 col-md-2 col-lg-2 col-sty" id="left">
                        <!-- Sidebar -->
                        <div id="sidebar">
                            <div id="sidebar-header" class="m-3 mb-5">
                                <img src="images/logo.png" alt="Sidebar Logo" style="width: 100%;">
                            </div>
                            <div id="sidebar-content">
                                <div class="list-group list-group-flush">
                                    <a href="#" class="list-group-item list-group-item-action bg-purple"><span style="padding-left: 10px;color: white;">Dashboard</span></a>
                                    <a href="#" class="list-group-item list-group-item-action bg-purple"><span style="padding-left: 10px;color: white;">Register</span></a>
                                    <a href="company.html" class="list-group-item list-group-item-action bg-purple"><span style="padding-left: 10px;color: white;">Companies</span></a>
                                    <div style="position: fixed; bottom: 0; display: inline-flex;" class="m-3">
                                        <img src="icon/Vector.png" id="icon">
                                        <span class="content text-white list-group-item">Logout</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Main Content -->
                    <div class="col-sm-12 col-xl-10 col-md-12 col-lg-10 col-sty" id="fix">
                        <div class="container container-sty text-center">
                            <h2 class="text-center m-3 fw-bold"> COMPANY REGISTRATION </h2>
                            <div class="container-form">
                                <form id="registerForm">
                                    <input type="text" class="form-control" id="companyName" placeholder="Company Name*"
                                        required>


                                    <div class="inline-fields">
                                        <input type="text" class="form-control" id="firstName" placeholder="First Name*"
                                            required>
                                        <input type="text" class="form-control" id="lastName" placeholder="Last Name*"
                                            required>
                                    </div>

                                    <input type="email" class="form-control" id="email" placeholder="Email*" required>
                                    <input type="tel" class="form-control" id="phone" placeholder="Phone Number*"
                                        required>

                                    <div class="submit-btn-container">
                                        <button type="submit" class="submit-btn" id="submit-btn">Submit</button>
                                    </div>
                                </form>
                               
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
   
    <div id="loadingOverlay" class="loading-overlay d-none">
        <div class="spinner-border text-light" role="status">
            <span class="sr-only"></span>
        </div>
    </div>

    <div id="popupModal">
        <div class="modal-content">
            <h3>Success!</h3>
            <p>Your account has been created</p>
            <div class="checkmark-container">
                <svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">
                    <g stroke="currentColor" stroke-width="2" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round">
                      <path class="circle" d="M13 1C6.372583 1 1 6.372583 1 13s5.372583 12 12 12 12-5.372583 12-12S19.627417 1 13 1z"/>
                      <path class="tick" d="M6.5 13.5L10 17 l8.808621-8.308621"/>
                    </g>
                  </svg>
            </div>
            <button class="close-btn" id="closePopup">Continue</button>
        </div>
    </div>

    <div id="popupModalFailure">
        <div class="modal-content">
            <h3>Failure!</h3>
            <p id="txt"></p>
            <div class="checkmark-container">
                <svg class="cross__svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
                    <circle class="cross__circle" cx="26" cy="26" r="25" fill="none"/>
                    <path class="cross__path cross__path--right" fill="none" d="M16,16 l20,20" />
                    <path class="cross__path cross__path--right" fill="none" d="M16,36 l20,-20" />
                </svg>
            </div>
            <button class="close-btn"   id="closePopupFailure">Retry</button>
        </div>
    </div>

    <script>

        document.getElementById('submit-btn').addEventListener('click', function (event) {
            event.preventDefault();
            const loadingOverlay = document.getElementById('loadingOverlay');
            const mainContent = document.getElementById('mainContent');
            loadingOverlay.classList.remove('d-none');
            mainContent.classList.add('blur-background');
            // Gather input values
            const data = {
                company_name: document.getElementById('companyName').value,
                phone_number: document.getElementById('phone').value.toString(),
                first_name: document.getElementById('firstName').value,
                last_name: document.getElementById('lastName').value,
                email: document.getElementById('email').value
            };

            console.log(data);

            fetch("https://m4j8v747jb.execute-api.us-west-2.amazonaws.com/dev//company_register/create", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
                .then(response => {

                    loadingOverlay.classList.add('d-none');
                   
                    if (!response.ok) {
                        throw new Error(`Error: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.error) {
                        document.getElementById("txt").innerHTML=data.error;
                        popupModalFailure.style.display = 'block';
                        mainContent.classList.add('blur-background');
                        closePopupFailure.addEventListener('click', function () {
          
                            popupModalFailure.style.display = 'none';
                            mainContent.classList.remove('blur-background');
                        });
                    }
                     else {
                        //SuccessModal
                        popupModal.style.display = 'block';
                        mainContent.classList.add('blur-background');
                        closePopup.addEventListener('click', function () {
                        window.location.href = 'company.html';
                       });
                    }
                })
                .catch(error => {
                  // Show failure modal on error
                  loadingSpinner.classList.add('d-none');
                    console.error('Error:', error);
                });
        });

        document.getElementById('sidebarToggle').addEventListener('click', function () {
            var sidebar = document.getElementById('left');
            sidebar.classList.toggle('active');
        });
    </script>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>



</body>

</html>